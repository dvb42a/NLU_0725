
<!-- Nav items -->
<ul class="navbar-nav">
    <li class="nav-item">
        <a class="nav-link" href="#navbar-dashboards" data-toggle="collapse" role="button" aria-expanded="false"
           aria-controls="navbar-dashboards">
            <i class="ni ni-tv-2 text-primary"></i>
            <span class="nav-link-text">儀表板</span>
        </a>
        <!-- 細項 -->
        <div class="collapse" id="navbar-dashboards" style="">
            <ul class="nav nav-sm flex-column">
                <li class="nav-item">
                    <a href="{% url "app:dashboard" %}" class="nav-link">
                        <span class="sidenav-normal"> App 列表 </span>
                    </a>
                </li>
            </ul>
        </div>
    </li>
    {% if dashborad%}
        <li class="nav-item">
            <a class="nav-link" href="#navbar-case" data-toggle="collapse" role="button" aria-expanded="falsfe"
               aria-controls="navbar-case">
                <i class="ni ni-bullet-list-67 text-primary"></i>
                <span class="nav-link-text">方案相關</span>
            </a>
            <!-- 細項 -->
            <div class="collapse" id="navbar-case" style="">
                <ul class="nav nav-sm flex-column">
                    <li class="nav-item">
                        <a href="{% url "Client:app" %}" class="nav-link">
                            <span class="sidenav-normal"> 方案管理 </span>
                        </a>
                    </li>
                </ul>
                <ul class="nav nav-sm flex-column">
                    <li class="nav-item">
                        <a href="{% url "home" %}"  class="nav-link">
                            <span class="sidenav-normal"> 方案選擇 </span>
                        </a>
                    </li>
                </ul>
                <ul class="nav nav-sm flex-column">
                    <li class="nav-item">
                        <a href="{% url "Client:order" %}" class="nav-link">
                            <span class="sidenav-normal"> 訂單查詢 </span>
                        </a>
                    </li>
                </ul>
            </div>
        </li>


    {% else %}
        <li class="nav-item">
            <a class="nav-link" href="#navbar-Manage" data-toggle="collapse" role="button" aria-expanded="false"
               aria-controls="navbar-Manage">
                <i class="ni ni-app text-blue"></i>
                <span class="nav-link-text">App 管理</span>
            </a>
            <!-- 細項 -->
            <div class="collapse" id="navbar-Manage" style="">
                <ul class="nav nav-sm flex-column">
                    <li class="nav-item">
                        <a href="{% url "app:manage_info" %}?{{ url }}" class="nav-link">
                            <span class="sidenav-normal"> 資訊 </span>
                        </a>
                    </li>
                </ul>
            </div>
        </li>

        <li class="nav-item">
            <a class="nav-link" href="#navbar-Build" data-toggle="collapse" role="button" aria-expanded="false"
               aria-controls="navbar-Build">
                <i class="ni ni-building text-red"></i>
                <span class="nav-link-text">建置</span>
            </a>
            <!-- 細項 -->
            <div class="collapse" id="navbar-Build" style="">
                <ul class="nav nav-sm flex-column">
                    <li class="nav-item ">
                        <a href="{% url "app:intent" %}?{{ url }}" class="nav-link">
                            <span class="sidenav-normal"> Intent(意圖) </span>
                        </a>
                    </li>
                </ul>
                <ul class="nav nav-sm flex-column">
                    <li class="nav-item">
                        <a href="{% url "app:entity" %}?{{ url }}" class="nav-link">
                            <span class="sidenav-normal"> Entity(實體) </span>
                        </a>
                    </li>
                </ul>
            </div>
        </li>

        <li class="nav-item">
            <a class="nav-link" href="#navbar-Dialogue" data-toggle="collapse" role="button" aria-expanded="false"
               aria-controls="navbar-Dialogue">
                <i class="ni ni-chat-round text-black-50"></i>
                <span class="nav-link-text">對話管理</span>
            </a>
            <!-- 細項 -->
            <div class="collapse" id="navbar-Dialogue" style="">
                <ul class="nav nav-sm flex-column">
                    <li class="nav-item">
                        <a href="{% url "app:rules" %}?{{ url }}" class="nav-link">
                            <span class="sidenav-normal"> (任務)意圖回應 </span>
                        </a>
                    </li>
                </ul>
            </div>
        </li>

        <li class="nav-item">
            <a class="nav-link" href="#navbar-Test" data-toggle="collapse" role="button" aria-expanded="false"
               aria-controls="navbar-Test">
                <i class="ni ni-settings text-green"></i>
                <span class="nav-link-text">測試</span>
            </a>
            <!-- 細項 -->
            <div class="collapse" id="navbar-Test" style="">
                <ul class="nav nav-sm flex-column">
                    <li class="nav-item">
                        <a href="{% url "app:test_chat" %}?{{ url }}" class="nav-link">
                            <span class="sidenav-normal"> 問答測試 </span>
                        </a>
                    </li>
                </ul>
                <ul class="nav nav-sm flex-column">
                    <li class="nav-item">
                        <a href="{% url "app:qa_log" %}?{{ url }}" class="nav-link">
                            <span class="sidenav-normal"> 對話紀錄 </span>
                        </a>
                    </li>
                </ul>
            </div>
        </li>
    {% endif %}

    <li class="nav-item">
        <a class="nav-link" href="#navbar-Report" data-toggle="collapse" role="button" aria-expanded="false"
           aria-controls="navbar-Test">
        <i class="ni ni-tag"></i>
        <span class="nav-link-text">任務報告&emsp;</span>
            {% if in_training == 1 %}
                <span class="badge badge-pill badge-info">!</span>
            {% endif %}
        </a>
        <!-- 細項 -->
        {% if in_training == 1 %}
        <div class="collapse" id="navbar-Report" style="">
            <ul class="nav nav-sm flex-column">
                <li class="nav-item">
                    <div class="nav-link" style="display: flex; justify-content: space-between;">
                        <span id=train_name style="text-align: left;">train_name</span>
                        <span id=train_process style="text-align: right;">train_process</span>
                    </div>
                </li>
                <li class="nav-item" style="padding-top: 0.45rem; padding-bottom: 0.45rem; padding-left: 3.5rem; padding-right:1.5rem;">
                        <div class="progress" >
                            <div class="progress-bar bg-primary" id="progress-bar" role="progressbar" style="width:{{train_process}};"></div>
                        </div>
                </li>
            </ul>
        </div>
        {% else %}
        <div class="collapse" id="navbar-Report" style="">
            <ul class="nav nav-sm flex-column">
                <li class="nav-item">
                    <div class="nav-link" style="display: flex; justify-content: space-between;">
                        <span style="text-align: left;">無特別訊息</span>
                    </div>
                </li>
            </ul>
        </div>
        {% endif %}
    </li>
        <li class="nav-item">
        <a class="nav-link" href="#ContactKingly" data-toggle="modal" role="button">
            <i class="ni ni-email-83 text-primary"></i>
            <span class="nav-link-text">聯絡王道</span>
        </a>
    </li>
</ul>

<!-- Divider -->
<hr class="my-3">
<!-- Heading -->
<h5 class="navbar-heading p-0 text-muted">
    {% if role == "main_ac" %}
        <span class="docs-normal">此帳號為主帳號</span>
    {% elif role == "sec_ac" %}
        <span class="docs-normal">此帳號為副帳號</span>
    {% else %}
        <span class="docs-normal">此帳號免費測帳號</span>
    {% endif %}
</h5>
<!-- Navigation -->
<ul class="navbar-nav mb-md-3">
    <li class="nav-item">
        <a href="{% url "Accounts:edit" %}" class="nav-link">
            <i class="ni ni-badge"></i>
            <span class="nav-link-text">修改帳號資訊</span>
        </a>
<!--        <a class="nav-link" target="_blank">-->
<!--            <i class="ni ni-single-02"></i>-->
<!--            <span class="nav-link-text">{{ account }}</span>-->
<!--        </a>-->
        <a href="{% url "Accounts:logout" %}" class="nav-link">
            <i class="ni ni-user-run"></i>
            <span class="nav-link-text">登出</span>
        </a>
    </li>
</ul>
<div class="modal fade" id="ContactKingly" tabindex="-1" role="dialog"
             aria-labelledby="ContactKinglyTitle"
             aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ContactKinglyTitle">聯絡王道</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form action="#" method="post">
                {% csrf_token %}
                <div class="modal-body">
                            <div class="mat-dialog-content">
                                <div class="form-row">
                                    <div class="col-sm-3" style="text-align: right;">公司名稱：</div>
                                    <div class="col-sm-9">
                                    <input style="width: 100%; height:25px" required autocomplete="off" class="" name="company_name"
                                           id="company-name" role="textbox" type="text">
                                    </div>
                                </div><p></p>
                                <div class="form-row">
                                    <div class="col-sm-3" style="text-align: right;">Email：</div>
                                    <div class="col-sm-9">
                                    <input style="width: 100%; height:25px" required autocomplete="off" class="" name="email"
                                           id="email" role="textbox" type="text">
                                    </div>
                                </div><p></p>
                                <div class="form-row">
                                    <div class="col-sm-3" style="text-align: right;">電話：</div>
                                    <div class="col-sm-9">
                                    <input style="width: 100%; height:25px" required autocomplete="off" class="" name="number"
                                           id="number" role="textbox" type="text">
                                    </div>
                                </div><p></p>
                                <div class="form-row">
                                    <div class="col-sm-3" style="text-align: right;">主旨：</div>
                                    <div class="col-sm-9">
                                    <select style="width: 100%; height:25px" class="" id="app-culture">
                                        <option value="1" class="">Test1</option>
                                        <option value="2" class="">Test2</option>
                                        <option value="3" class="">Test3</option>
                                        <option value="4" class="">Test4</option>
                                    </select></div>
                                </div><p></p>
                                <div class="form-row ml-1" style="text-align: left;">訊息：</div>
                                <div class="form-row ml-1">
                                    <textarea style="width: 100%; height:300px;" name="message" id="message"></textarea>
                                </div>
                            </div>
                        </div>
                <div class="modal-footer" id="message_div">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="message_done_btn" disabled>Done</button>
                    <button type="submit" id="message_post_btn" style="display:none;"></button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    {% if in_training == 1 %}
        source = new EventSource('{% url "app:train_event"%}');
        source.onmessage = function (event) {
            var data = JSON.parse(event.data);
            $("#train_name").text(data.in_train_name);
            var trainProcess = data.train_process + "%"
            var process = parseInt(data.train_process)
            document.getElementById("progress-bar").style.width = trainProcess;
            if (process == 0){
                $("#train_process").text('訓練準備中...');
            }
            else if (process == 100){
                alert('訓練任務：' + data.in_train_name + ', 已訓練完成!');
                window.location.reload()
            }
            else {
                $("#train_process").text(trainProcess);
            }
        };
    {% endif %}
</script>

